(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9882:function(e,t,r){Promise.resolve().then(r.bind(r,6281)),Promise.resolve().then(r.t.bind(r,4742,23)),Promise.resolve().then(r.t.bind(r,7960,23))},6281:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return c},a:function(){return i}});var o=r(7437),n=r(2265),a=r(9116);let s=(0,n.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[i,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{try{if(localStorage.getItem("auth_token")){let e=await a.h.getCurrentUser();c(e.user)}}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("auth_token")}finally{u(!1)}})()},[]);let h=async(e,t)=>{c((await a.h.login(e,t)).user)},l=async(e,t,r)=>{c((await a.h.register(e,t,r)).user)},f=async(e,t)=>{c((await a.h.changePassword(e,t)).user)};return(0,o.jsx)(s.Provider,{value:{user:r,loading:i,login:h,register:l,logout:()=>{a.h.logout(),c(null)},changePassword:f,isAuthenticated:!!r,needsPasswordChange:!!r&&!r.password_changed},children:t})}function i(){let e=(0,n.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,t,r){"use strict";r.d(t,{h:function(){return s}});let o=r(257).env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api",n=()=>localStorage.getItem("auth_token"),a=()=>{let e=n(),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t},s={register:async(e,t,r)=>{let n=await fetch("".concat(o,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:r})});if(!n.ok){let e=await n.json().catch(()=>({error:"Unknown error occurred"}));throw Error(e.error||e.message||"Registration failed")}let a=await n.json();return a.token&&localStorage.setItem("auth_token",a.token),a},login:async(e,t)=>{let r=await fetch("".concat(o,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(!r.ok){let e=await r.json().catch(()=>({error:"Unknown error occurred"}));throw Error(e.error||e.message||"Login failed")}let n=await r.json();return n.token&&localStorage.setItem("auth_token",n.token),n},logout:()=>{localStorage.removeItem("auth_token")},getCurrentUser:async()=>{let e=await fetch("".concat(o,"/auth/me"),{method:"GET",headers:a()});if(!e.ok){if(401===e.status)throw localStorage.removeItem("auth_token"),Error("Unauthorized");let t=await e.json().catch(()=>({error:"Unknown error occurred"}));throw Error(t.error||t.message||"Failed to get user")}return e.json()},changePassword:async(e,t)=>{let r=await fetch("".concat(o,"/auth/change-password"),{method:"POST",headers:a(),body:JSON.stringify({currentPassword:e,newPassword:t})});if(!r.ok){let e=await r.json().catch(()=>({error:"Unknown error occurred"}));throw Error(e.error||e.message||"Failed to change password")}return r.json()},codeReview:async(e,t)=>(await fetch("".concat(o,"/code-review"),{method:"POST",headers:a(),body:JSON.stringify({repoPath:e,query:t})})).json(),getCodeReviewReports:async()=>(await fetch("".concat(o,"/code-review/reports"),{headers:a()})).json(),threatModeling:async(e,t)=>(await fetch("".concat(o,"/threat-modeling"),{method:"POST",headers:a(),body:JSON.stringify({repoPath:e,query:t})})).json(),getThreatModelingReports:async()=>(await fetch("".concat(o,"/threat-modeling/reports"),{headers:a()})).json(),chat:async(e,t,r)=>{try{let n=await fetch("".concat(o,"/chat"),{method:"POST",headers:a(),body:JSON.stringify({message:e,role:t,history:r})});if(!n.ok){let e=await n.json().catch(()=>({error:"Unknown error occurred"})),t=e.message||e.error||"HTTP error! status: ".concat(n.status);throw Error(t)}let s=await n.json();return console.log("Chat API response:",s),s}catch(e){if(console.error("Chat API error:",e),e instanceof TypeError&&e.message.includes("fetch"))throw Error("Unable to connect to server. Please ensure the backend is running.");throw e}},endChat:async()=>{try{let e=await fetch("".concat(o,"/chat/end"),{method:"POST",headers:a()});if(!e.ok){let t=await e.json().catch(()=>({error:"Unknown error occurred"}));throw Error(t.message||t.error||"Failed to end chat session")}return e.json()}catch(e){throw console.error("End chat error:",e),e}},getChatSession:async()=>{try{let e=await fetch("".concat(o,"/chat/session"),{method:"GET",headers:a()});if(!e.ok){let t=await e.json().catch(()=>({error:"Unknown error occurred"}));throw Error(t.message||t.error||"Failed to get session status")}return e.json()}catch(e){throw console.error("Get chat session error:",e),e}}}},257:function(e,t,r){"use strict";var o,n;e.exports=(null==(o=r.g.process)?void 0:o.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,o,n=e.exports={};function a(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var i=[],u=!1,h=-1;function l(){u&&o&&(u=!1,o.length?i=o.concat(i):h=-1,i.length&&f())}function f(){if(!u){var e=c(l);u=!0;for(var t=i.length;t;){for(o=i,i=[];++h<t;)o&&o[h].run();h=-1,t=i.length}o=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.push(new d(e,t)),1!==i.length||u||c(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}},s=!0;try{t[e](a,a.exports,o),s=!1}finally{s&&delete r[e]}return a.exports}o.ab="//";var n=o(229);e.exports=n}()},7960:function(){},4742:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[540,971,117,744],function(){return e(e.s=9882)}),_N_E=e.O()}]);