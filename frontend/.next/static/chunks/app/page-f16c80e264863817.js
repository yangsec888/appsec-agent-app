(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1972:function(e,t,s){Promise.resolve().then(s.bind(s,403))},403:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return L}});var r=s(7437),a=s(2265),n=s(1994),l=s(3335);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.m6)((0,n.W)(t))}let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});o.displayName="Card";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("flex flex-col space-y-1.5 p-6",s),...a})});c.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:i("text-2xl font-semibold leading-none tracking-tight",s),...a})});d.displayName="CardTitle";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:i("text-sm text-muted-foreground",s),...a})});u.displayName="CardDescription";let m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("p-6 pt-0",s),...a})});m.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter";var h=s(7053);let x=(0,s(535).j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),p=a.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:l=!1,...o}=e,c=l?h.g7:"button";return(0,r.jsx)(c,{className:i(x({variant:a,size:n,className:s})),ref:t,...o})});p.displayName="Button";let f=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});f.displayName="Input";let g=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:i("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});g.displayName="Textarea";var j=s(9116);function v(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)("Review this codebase for security vulnerabilities"),[l,i]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),[v,y]=(0,a.useState)(null),b=async t=>{t.preventDefault(),i(!0),y(null),x(null);try{let t=await j.h.codeReview(e,s);x(t)}catch(e){y(e.message||"Failed to perform code review")}finally{i(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(o,{children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Code Review"}),(0,r.jsx)(u,{children:"Run security code reviews on uploaded repositories"})]}),(0,r.jsx)(m,{children:(0,r.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"repoPath",className:"text-sm font-medium mb-2 block",children:"Repository Path"}),(0,r.jsx)(f,{id:"repoPath",type:"text",placeholder:"/path/to/repository",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"query",className:"text-sm font-medium mb-2 block",children:"Review Query"}),(0,r.jsx)(g,{id:"query",placeholder:"Enter your review query...",value:s,onChange:e=>n(e.target.value),rows:4})]}),(0,r.jsx)(p,{type:"submit",disabled:l,children:l?"Running Review...":"Run Code Review"})]})})]}),v&&(0,r.jsx)(o,{children:(0,r.jsx)(m,{className:"pt-6",children:(0,r.jsx)("div",{className:"text-destructive",children:v})})}),h&&(0,r.jsxs)(o,{children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Review Results"}),(0,r.jsx)(u,{children:"Code review completed successfully"})]}),(0,r.jsx)(m,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Status:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:h.status})]}),h.reportPath&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Report Path:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:h.reportPath})]}),h.reportContent&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Report Preview:"}),(0,r.jsx)("div",{className:"bg-muted p-4 rounded-md max-h-96 overflow-auto",children:(0,r.jsx)("pre",{className:"text-sm whitespace-pre-wrap",children:h.reportContent})})]})]})})]})]})}function y(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)("Perform threat modeling analysis"),[l,i]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),[v,y]=(0,a.useState)(null),b=async t=>{t.preventDefault(),i(!0),y(null),x(null);try{let t=await j.h.threatModeling(e,s);x(t)}catch(e){y(e.message||"Failed to perform threat modeling")}finally{i(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(o,{children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Threat Modeling"}),(0,r.jsx)(u,{children:"View threat modeling reports for your applications"})]}),(0,r.jsx)(m,{children:(0,r.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"repoPath",className:"text-sm font-medium mb-2 block",children:"Repository Path"}),(0,r.jsx)(f,{id:"repoPath",type:"text",placeholder:"/path/to/repository",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"query",className:"text-sm font-medium mb-2 block",children:"Analysis Query"}),(0,r.jsx)(g,{id:"query",placeholder:"Enter your threat modeling query...",value:s,onChange:e=>n(e.target.value),rows:4})]}),(0,r.jsx)(p,{type:"submit",disabled:l,children:l?"Running Analysis...":"Run Threat Modeling"})]})})]}),v&&(0,r.jsx)(o,{children:(0,r.jsx)(m,{className:"pt-6",children:(0,r.jsx)("div",{className:"text-destructive",children:v})})}),h&&(0,r.jsxs)(o,{children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Threat Modeling Results"}),(0,r.jsx)(u,{children:"Analysis completed successfully"})]}),(0,r.jsx)(m,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Status:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:h.status})]}),h.reportPath&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Report Path:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:h.reportPath})]}),h.reportContent&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Report Preview:"}),(0,r.jsx)("div",{className:"bg-muted p-4 rounded-md max-h-96 overflow-auto",children:(0,r.jsx)("pre",{className:"text-sm whitespace-pre-wrap",children:h.reportContent})})]})]})})]})]})}var b=s(236),w=s(3260);function N(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(!1),[l,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),m=(0,a.useRef)(null);(0,a.useEffect)(()=>{m.current&&(m.current.style.height="52px",m.current.style.height="".concat(Math.min(m.current.scrollHeight,200),"px"))},[e]);let h=async s=>{if(s.preventDefault(),!e.trim())return;n(!0),c(null);let r={role:"user",content:e};i(e=>[...e,r]),t("");try{if("/end"===r.content.trim().toLowerCase()){let e=await j.h.chat(r.content);i(t=>[...t,{role:"assistant",content:e.response||"Chat session ended. Starting a new conversation."}]),u(!1),setTimeout(()=>{i([])},2e3);return}let e=await j.h.chat(r.content,void 0,l);if(e&&e.response)i(t=>[...t,{role:"assistant",content:e.response}]),e.sessionEnded?u(!1):!1!==e.sessionActive&&u(!0);else throw Error("Invalid response format from server")}catch(t){let e=t.message||"Failed to send message";console.error("Chat error:",t),c(e),i(t=>[...t,{role:"assistant",content:"Error: ".concat(e)}])}finally{n(!1)}},x=async()=>{try{n(!0),await j.h.endChat(),u(!1),i([])}catch(e){c(e.message||"Failed to end chat session")}finally{n(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,r.jsx)("div",{className:"container mx-auto max-w-3xl px-4 py-8",children:0===l.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:"Start a conversation"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Ask a question about security to get started"})]})}):(0,r.jsx)("div",{className:"space-y-6",children:l.map((e,t)=>(0,r.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,r.jsx)("div",{className:"max-w-[85%] ".concat("user"===e.role?"bg-primary text-primary-foreground rounded-2xl rounded-tr-sm px-4 py-3":"bg-muted rounded-2xl rounded-tl-sm px-4 py-3"),children:"assistant"===e.role?(0,r.jsx)("div",{className:"prose prose-sm max-w-none dark:prose-invert prose-headings:font-semibold prose-p:my-2 prose-pre:bg-background/50 prose-code:text-foreground",children:(0,r.jsx)(b.UG,{remarkPlugins:[w.Z],components:{code:e=>{let{node:t,inline:s,className:a,children:n,...l}=e,i=/language-(\w+)/.exec(a||"");return!s&&i?(0,r.jsx)("pre",{className:"bg-background/50 p-3 rounded-md overflow-x-auto text-foreground my-2",children:(0,r.jsx)("code",{className:"".concat(a," text-foreground font-mono text-sm"),...l,children:n})}):(0,r.jsx)("code",{className:"bg-background/50 px-1.5 py-0.5 rounded text-sm text-foreground font-mono",...l,children:n})},h1:e=>{let{children:t}=e;return(0,r.jsx)("h1",{className:"text-xl font-semibold mt-4 mb-2",children:t})},h2:e=>{let{children:t}=e;return(0,r.jsx)("h2",{className:"text-lg font-semibold mt-3 mb-2",children:t})},h3:e=>{let{children:t}=e;return(0,r.jsx)("h3",{className:"text-base font-semibold mt-2 mb-1",children:t})},ul:e=>{let{children:t}=e;return(0,r.jsx)("ul",{className:"list-disc list-inside my-2 space-y-1",children:t})},ol:e=>{let{children:t}=e;return(0,r.jsx)("ol",{className:"list-decimal list-inside my-2 space-y-1",children:t})},li:e=>{let{children:t}=e;return(0,r.jsx)("li",{className:"ml-4",children:t})},p:e=>{let{children:t}=e;return(0,r.jsx)("p",{className:"my-2 leading-relaxed",children:t})},blockquote:e=>{let{children:t}=e;return(0,r.jsx)("blockquote",{className:"border-l-4 border-muted-foreground/30 pl-4 italic my-2",children:t})},a:e=>{let{children:t,href:s}=e;return(0,r.jsx)("a",{href:s,className:"text-primary underline hover:text-primary/80",target:"_blank",rel:"noopener noreferrer",children:t})},table:e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"overflow-x-auto my-2",children:(0,r.jsx)("table",{className:"min-w-full border-collapse border border-border/50",children:t})})},th:e=>{let{children:t}=e;return(0,r.jsx)("th",{className:"border border-border/50 px-4 py-2 bg-background/50 font-semibold",children:t})},td:e=>{let{children:t}=e;return(0,r.jsx)("td",{className:"border border-border/50 px-4 py-2",children:t})}},children:e.content})}):(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:e.content})})},t))})})}),(0,r.jsx)("div",{className:"border-t bg-background",children:(0,r.jsxs)("div",{className:"container mx-auto max-w-3xl px-4 py-4",children:[o&&(0,r.jsx)("div",{className:"mb-2 text-sm text-destructive",children:o}),d&&(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between text-xs text-muted-foreground",children:[(0,r.jsx)("span",{children:"\uD83D\uDCAC Active chat session - conversation history is maintained"}),(0,r.jsx)(p,{variant:"ghost",size:"sm",onClick:x,disabled:s,className:"h-6 px-2 text-xs",children:"End Session"})]}),(0,r.jsxs)("form",{onSubmit:h,className:"flex items-end gap-2",children:[(0,r.jsx)("div",{className:"flex-1 relative",children:(0,r.jsx)(g,{ref:m,placeholder:d?"Message Claude... (type '/end' to end session)":"Message Claude...",value:e,onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h(e))},className:"min-h-[52px] max-h-[200px] resize-none pr-12",rows:1})}),(0,r.jsx)(p,{type:"submit",disabled:s||!e.trim(),className:"h-[52px] px-6",children:s?(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"animate-spin",children:"⏳"}),"Sending..."]}):"Send"})]}),(0,r.jsx)("div",{className:"mt-2 text-xs text-muted-foreground",children:(0,r.jsxs)("p",{children:["\uD83D\uDCA1 Tip: Type ",(0,r.jsx)("code",{className:"bg-muted px-1 rounded",children:"/end"})," to end the current chat session and start fresh"]})})]})})]})}let C="appsec_agent_config",S=()=>({anthropic:{apiKey:"your-api-key-here",baseUrl:"https://api.anthropic.com"}}),k=()=>{try{let s=localStorage.getItem(C);if(s){var e,t;let r=JSON.parse(s),a=S();return{anthropic:{apiKey:(null===(e=r.anthropic)||void 0===e?void 0:e.apiKey)||a.anthropic.apiKey,baseUrl:(null===(t=r.anthropic)||void 0===t?void 0:t.baseUrl)||a.anthropic.baseUrl}}}}catch(e){console.warn("Failed to load config from localStorage:",e)}return S()},P=e=>{try{let t={anthropic:{...k().anthropic,...e.anthropic}};localStorage.setItem(C,JSON.stringify(t))}catch(e){throw console.error("Failed to save config to localStorage:",e),Error("Failed to save configuration")}};function R(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(""),[l,i]=(0,a.useState)(!1),[h,x]=(0,a.useState)("");return(0,a.useEffect)(()=>{let e=k();t(e.anthropic.apiKey),n(e.anthropic.baseUrl)},[]),(0,r.jsx)("div",{className:"container mx-auto max-w-4xl p-8",children:(0,r.jsxs)(o,{children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Settings"}),(0,r.jsx)(u,{children:"Configure application settings. Changes are saved to your browser's local storage."})]}),(0,r.jsxs)(m,{className:"space-y-6",children:[h&&(0,r.jsx)("div",{className:"p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:h}),l&&(0,r.jsx)("div",{className:"p-3 text-sm text-green-600 bg-green-50 rounded-md",children:"✅ Configuration saved successfully!"}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Anthropic API Configuration"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"anthropic-api-key",className:"text-sm font-medium",children:"Anthropic API Key"}),(0,r.jsx)(f,{id:"anthropic-api-key",type:"password",value:e,onChange:e=>t(e.target.value),placeholder:"Enter your Anthropic API key"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Your API key is stored locally in your browser. It will be used for API calls."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"anthropic-base-url",className:"text-sm font-medium",children:"Anthropic Base URL"}),(0,r.jsx)(f,{id:"anthropic-base-url",type:"text",value:s,onChange:e=>n(e.target.value),placeholder:"https://api.anthropic.com"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"The base URL for the Anthropic API. Default: https://api.anthropic.com"})]})]})]})}),(0,r.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,r.jsx)(p,{onClick:()=>{try{P({anthropic:{apiKey:e,baseUrl:s}}),i(!0),x(""),setTimeout(()=>i(!1),3e3)}catch(e){x(e.message||"Failed to save configuration")}},children:"Save Configuration"}),(0,r.jsx)(p,{variant:"outline",onClick:()=>{let e={anthropic:{apiKey:"your-api-key-here",baseUrl:"https://api.anthropic.com"}};t(e.anthropic.apiKey),n(e.anthropic.baseUrl),P(e),i(!0),setTimeout(()=>i(!1),3e3)},children:"Reset to Defaults"})]}),(0,r.jsx)("div",{className:"pt-4 border-t",children:(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,r.jsx)("strong",{children:"Note:"})," Configuration is stored in your browser's local storage. To use environment variables instead, set NEXT_PUBLIC_ANTHROPIC_API_KEY and NEXT_PUBLIC_ANTHROPIC_BASE_URL in your .env.local file."]})})]})]})})}k();var E=s(6281);function A(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(""),[l,i]=(0,a.useState)(""),[h,x]=(0,a.useState)(!1),{login:g}=(0,E.a)(),j=async t=>{t.preventDefault(),i(""),x(!0);try{await g(e,s)}catch(e){i(e.message||"Login failed. Please try again.")}finally{x(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:(0,r.jsxs)(o,{className:"w-full max-w-md",children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Login"}),(0,r.jsx)(u,{children:"Enter your credentials to access the dashboard"})]}),(0,r.jsx)(m,{children:(0,r.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[l&&(0,r.jsx)("div",{className:"p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:l}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"username",className:"text-sm font-medium",children:"Username or Email"}),(0,r.jsx)(f,{id:"username",type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter your username or email",required:!0,disabled:h})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),(0,r.jsx)(f,{id:"password",type:"password",value:s,onChange:e=>n(e.target.value),placeholder:"Enter your password",required:!0,disabled:h})]}),(0,r.jsx)(p,{type:"submit",className:"w-full",disabled:h,children:h?"Logging in...":"Login"})]})})]})})}function T(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(""),[l,i]=(0,a.useState)(""),[h,x]=(0,a.useState)(""),[g,j]=(0,a.useState)(""),[v,y]=(0,a.useState)(!1),{register:b}=(0,E.a)(),w=async t=>{if(t.preventDefault(),j(""),l!==h){j("Passwords do not match");return}if(l.length<6){j("Password must be at least 6 characters long");return}y(!0);try{await b(e,s,l)}catch(e){j(e.message||"Registration failed. Please try again.")}finally{y(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:(0,r.jsxs)(o,{className:"w-full max-w-md",children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Create Account"}),(0,r.jsx)(u,{children:"Sign up to get started with AppSec Agent"})]}),(0,r.jsx)(m,{children:(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[g&&(0,r.jsx)("div",{className:"p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:g}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"username",className:"text-sm font-medium",children:"Username"}),(0,r.jsx)(f,{id:"username",type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Choose a username",required:!0,disabled:v})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),(0,r.jsx)(f,{id:"email",type:"email",value:s,onChange:e=>n(e.target.value),placeholder:"Enter your email",required:!0,disabled:v})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),(0,r.jsx)(f,{id:"password",type:"password",value:l,onChange:e=>i(e.target.value),placeholder:"Create a password (min. 6 characters)",required:!0,disabled:v})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"text-sm font-medium",children:"Confirm Password"}),(0,r.jsx)(f,{id:"confirmPassword",type:"password",value:h,onChange:e=>x(e.target.value),placeholder:"Confirm your password",required:!0,disabled:v})]}),(0,r.jsx)(p,{type:"submit",className:"w-full",disabled:v,children:v?"Creating account...":"Create Account"})]})})]})})}function F(e){let{children:t}=e,{isAuthenticated:s,loading:n}=(0,E.a)(),[l,i]=(0,a.useState)(!1);return n?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Loading..."})]})}):s?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)("div",{children:l?(0,r.jsxs)("div",{children:[(0,r.jsx)(T,{}),(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsx)("button",{onClick:()=>i(!1),className:"text-sm text-muted-foreground hover:text-primary",children:"Already have an account? Login"})})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)(A,{}),(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsx)("button",{onClick:()=>i(!0),className:"text-sm text-muted-foreground hover:text-primary",children:"Don't have an account? Register"})})]})})}function U(e){let{onClose:t,showCloseButton:s=!0}=e,[n,l]=(0,a.useState)(""),[i,h]=(0,a.useState)(""),[x,g]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),[y,b]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1),{changePassword:C}=(0,E.a)(),S=async e=>{if(e.preventDefault(),v(""),N(!1),i!==x){v("New passwords do not match");return}if(i.length<6){v("New password must be at least 6 characters long");return}b(!0);try{await C(n,i),N(!0),l(""),h(""),g(""),t&&setTimeout(()=>{t()},2e3)}catch(e){v(e.message||"Failed to change password. Please try again.")}finally{b(!1)}};return(0,r.jsxs)(o,{className:"w-full max-w-md mx-auto",children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{children:"Change Password"}),(0,r.jsx)(u,{children:s?"Please change your default password for security":"Update your password"})]}),(0,r.jsx)(m,{children:w?(0,r.jsx)("div",{className:"p-4 text-sm text-green-600 bg-green-50 rounded-md",children:"✅ Password changed successfully!"}):(0,r.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[j&&(0,r.jsx)("div",{className:"p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:j}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"currentPassword",className:"text-sm font-medium",children:"Current Password"}),(0,r.jsx)(f,{id:"currentPassword",type:"password",value:n,onChange:e=>l(e.target.value),placeholder:"Enter your current password",required:!0,disabled:y})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"newPassword",className:"text-sm font-medium",children:"New Password"}),(0,r.jsx)(f,{id:"newPassword",type:"password",value:i,onChange:e=>h(e.target.value),placeholder:"Enter new password (min. 6 characters)",required:!0,disabled:y})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"text-sm font-medium",children:"Confirm New Password"}),(0,r.jsx)(f,{id:"confirmPassword",type:"password",value:x,onChange:e=>g(e.target.value),placeholder:"Confirm new password",required:!0,disabled:y})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(p,{type:"submit",className:"flex-1",disabled:y,children:y?"Changing...":"Change Password"}),s&&t&&(0,r.jsx)(p,{type:"button",variant:"outline",onClick:t,disabled:y,children:"Cancel"})]})]})})]})}var I=s(2727);let _=I.fC,q=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(I.aV,{ref:t,className:i("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});q.displayName=I.aV.displayName;let O=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(I.xz,{ref:t,className:i("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});O.displayName=I.xz.displayName;let D=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(I.VY,{ref:t,className:i("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});function L(){return(0,r.jsx)(F,{children:(0,r.jsx)(K,{})})}function K(){let{user:e,logout:t,needsPasswordChange:s}=(0,E.a)(),[n,l]=(0,a.useState)(!1);return(0,r.jsxs)("main",{className:"min-h-screen bg-background",children:[s&&!n&&(0,r.jsx)("div",{className:"bg-yellow-50 border-b border-yellow-200 p-4",children:(0,r.jsx)("div",{className:"container mx-auto max-w-7xl px-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-yellow-600 font-semibold",children:"⚠️ Security Reminder"}),(0,r.jsx)("span",{className:"text-yellow-700 text-sm",children:"You are using the default password. Please change it immediately for security."})]}),(0,r.jsx)(p,{variant:"default",size:"sm",onClick:()=>l(!0),className:"bg-yellow-600 hover:bg-yellow-700",children:"Change Password"})]})})}),n&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)(U,{onClose:()=>l(!1),showCloseButton:!0})}),(0,r.jsxs)(_,{defaultValue:"chat",className:"w-full h-screen flex flex-col",children:[(0,r.jsx)("div",{className:"border-b",children:(0,r.jsx)("div",{className:"container mx-auto max-w-7xl px-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-14",children:[(0,r.jsxs)(q,{className:"h-14 bg-transparent border-0",children:[(0,r.jsx)(O,{value:"chat",className:"data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none",children:"Chat Interface"}),(0,r.jsx)(O,{value:"threat-modeling",className:"data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none",children:"Threat Modeling"}),(0,r.jsx)(O,{value:"code-review",className:"data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none",children:"Code Review"}),(0,r.jsx)(O,{value:"settings",className:"data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none",children:"Settings"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:null==e?void 0:e.username}),(0,r.jsx)(p,{variant:"outline",size:"sm",onClick:t,children:"Logout"})]})]})})}),(0,r.jsx)(D,{value:"chat",className:"flex-1 m-0 p-0",children:(0,r.jsx)(N,{})}),(0,r.jsx)(D,{value:"threat-modeling",className:"flex-1 m-0 p-0 overflow-auto",children:(0,r.jsx)("div",{className:"container mx-auto max-w-7xl p-8",children:(0,r.jsx)(y,{})})}),(0,r.jsx)(D,{value:"code-review",className:"flex-1 m-0 p-0 overflow-auto",children:(0,r.jsx)("div",{className:"container mx-auto max-w-7xl p-8",children:(0,r.jsx)(v,{})})}),(0,r.jsx)(D,{value:"settings",className:"flex-1 m-0 p-0 overflow-auto",children:(0,r.jsx)(R,{})})]})]})}D.displayName=I.VY.displayName},6281:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return i},a:function(){return o}});var r=s(7437),a=s(2265),n=s(9116);let l=(0,a.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{try{if(localStorage.getItem("auth_token")){let e=await n.h.getCurrentUser();i(e.user)}}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("auth_token")}finally{c(!1)}})()},[]);let d=async(e,t)=>{i((await n.h.login(e,t)).user)},u=async(e,t,s)=>{i((await n.h.register(e,t,s)).user)},m=async(e,t)=>{i((await n.h.changePassword(e,t)).user)};return(0,r.jsx)(l.Provider,{value:{user:s,loading:o,login:d,register:u,logout:()=>{n.h.logout(),i(null)},changePassword:m,isAuthenticated:!!s,needsPasswordChange:!!s&&!s.password_changed},children:t})}function o(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,t,s){"use strict";s.d(t,{h:function(){return l}});let r=s(257).env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api",a=()=>localStorage.getItem("auth_token"),n=()=>{let e=a(),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t},l={register:async(e,t,s)=>{let a=await fetch("".concat(r,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:s})});if(!a.ok){let e=await a.json().catch(()=>({error:"Unknown error occurred"}));throw Error(e.error||e.message||"Registration failed")}let n=await a.json();return n.token&&localStorage.setItem("auth_token",n.token),n},login:async(e,t)=>{let s=await fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(!s.ok){let e=await s.json().catch(()=>({error:"Unknown error occurred"}));throw Error(e.error||e.message||"Login failed")}let a=await s.json();return a.token&&localStorage.setItem("auth_token",a.token),a},logout:()=>{localStorage.removeItem("auth_token")},getCurrentUser:async()=>{let e=await fetch("".concat(r,"/auth/me"),{method:"GET",headers:n()});if(!e.ok){if(401===e.status)throw localStorage.removeItem("auth_token"),Error("Unauthorized");let t=await e.json().catch(()=>({error:"Unknown error occurred"}));throw Error(t.error||t.message||"Failed to get user")}return e.json()},changePassword:async(e,t)=>{let s=await fetch("".concat(r,"/auth/change-password"),{method:"POST",headers:n(),body:JSON.stringify({currentPassword:e,newPassword:t})});if(!s.ok){let e=await s.json().catch(()=>({error:"Unknown error occurred"}));throw Error(e.error||e.message||"Failed to change password")}return s.json()},codeReview:async(e,t)=>(await fetch("".concat(r,"/code-review"),{method:"POST",headers:n(),body:JSON.stringify({repoPath:e,query:t})})).json(),getCodeReviewReports:async()=>(await fetch("".concat(r,"/code-review/reports"),{headers:n()})).json(),threatModeling:async(e,t)=>(await fetch("".concat(r,"/threat-modeling"),{method:"POST",headers:n(),body:JSON.stringify({repoPath:e,query:t})})).json(),getThreatModelingReports:async()=>(await fetch("".concat(r,"/threat-modeling/reports"),{headers:n()})).json(),chat:async(e,t,s)=>{try{let a=await fetch("".concat(r,"/chat"),{method:"POST",headers:n(),body:JSON.stringify({message:e,role:t,history:s})});if(!a.ok){let e=await a.json().catch(()=>({error:"Unknown error occurred"})),t=e.message||e.error||"HTTP error! status: ".concat(a.status);throw Error(t)}let l=await a.json();return console.log("Chat API response:",l),l}catch(e){if(console.error("Chat API error:",e),e instanceof TypeError&&e.message.includes("fetch"))throw Error("Unable to connect to server. Please ensure the backend is running.");throw e}},endChat:async()=>{try{let e=await fetch("".concat(r,"/chat/end"),{method:"POST",headers:n()});if(!e.ok){let t=await e.json().catch(()=>({error:"Unknown error occurred"}));throw Error(t.message||t.error||"Failed to end chat session")}return e.json()}catch(e){throw console.error("End chat error:",e),e}},getChatSession:async()=>{try{let e=await fetch("".concat(r,"/chat/session"),{method:"GET",headers:n()});if(!e.ok){let t=await e.json().catch(()=>({error:"Unknown error occurred"}));throw Error(t.message||t.error||"Failed to get session status")}return e.json()}catch(e){throw console.error("Get chat session error:",e),e}}}}},function(e){e.O(0,[509,971,117,744],function(){return e(e.s=1972)}),_N_E=e.O()}]);